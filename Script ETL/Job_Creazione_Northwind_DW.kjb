<?xml version="1.0" encoding="UTF-8"?>
<job>
  <name>Job_Creazione_Northwind_DW</name>
  <description/>
  <extended_description/>
  <job_version/>
  <directory>/</directory>
  <created_user>-</created_user>
  <created_date>2022/01/08 18:33:31.536</created_date>
  <modified_user>-</modified_user>
  <modified_date>2022/01/08 18:33:31.536</modified_date>
  <parameters>
    </parameters>
  <connection>
    <name>Connessione_DW</name>
    <server>localhost</server>
    <type>MYSQL</type>
    <access>Native</access>
    <database>northwind_dw</database>
    <port>3306</port>
    <username>root</username>
    <password>Encrypted 2be98afc86aa7f289a215a764db80a1d3</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>3306</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>STREAM_RESULTS</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <slaveservers>
    </slaveservers>
  <job-log-table>
    <connection/>
    <schema/>
    <table/>
    <size_limit_lines/>
    <interval/>
    <timeout_days/>
    <field>
      <id>ID_JOB</id>
      <enabled>Y</enabled>
      <name>ID_JOB</name>
    </field>
    <field>
      <id>CHANNEL_ID</id>
      <enabled>Y</enabled>
      <name>CHANNEL_ID</name>
    </field>
    <field>
      <id>JOBNAME</id>
      <enabled>Y</enabled>
      <name>JOBNAME</name>
    </field>
    <field>
      <id>STATUS</id>
      <enabled>Y</enabled>
      <name>STATUS</name>
    </field>
    <field>
      <id>LINES_READ</id>
      <enabled>Y</enabled>
      <name>LINES_READ</name>
    </field>
    <field>
      <id>LINES_WRITTEN</id>
      <enabled>Y</enabled>
      <name>LINES_WRITTEN</name>
    </field>
    <field>
      <id>LINES_UPDATED</id>
      <enabled>Y</enabled>
      <name>LINES_UPDATED</name>
    </field>
    <field>
      <id>LINES_INPUT</id>
      <enabled>Y</enabled>
      <name>LINES_INPUT</name>
    </field>
    <field>
      <id>LINES_OUTPUT</id>
      <enabled>Y</enabled>
      <name>LINES_OUTPUT</name>
    </field>
    <field>
      <id>LINES_REJECTED</id>
      <enabled>Y</enabled>
      <name>LINES_REJECTED</name>
    </field>
    <field>
      <id>ERRORS</id>
      <enabled>Y</enabled>
      <name>ERRORS</name>
    </field>
    <field>
      <id>STARTDATE</id>
      <enabled>Y</enabled>
      <name>STARTDATE</name>
    </field>
    <field>
      <id>ENDDATE</id>
      <enabled>Y</enabled>
      <name>ENDDATE</name>
    </field>
    <field>
      <id>LOGDATE</id>
      <enabled>Y</enabled>
      <name>LOGDATE</name>
    </field>
    <field>
      <id>DEPDATE</id>
      <enabled>Y</enabled>
      <name>DEPDATE</name>
    </field>
    <field>
      <id>REPLAYDATE</id>
      <enabled>Y</enabled>
      <name>REPLAYDATE</name>
    </field>
    <field>
      <id>LOG_FIELD</id>
      <enabled>Y</enabled>
      <name>LOG_FIELD</name>
    </field>
    <field>
      <id>EXECUTING_SERVER</id>
      <enabled>N</enabled>
      <name>EXECUTING_SERVER</name>
    </field>
    <field>
      <id>EXECUTING_USER</id>
      <enabled>N</enabled>
      <name>EXECUTING_USER</name>
    </field>
    <field>
      <id>START_JOB_ENTRY</id>
      <enabled>N</enabled>
      <name>START_JOB_ENTRY</name>
    </field>
    <field>
      <id>CLIENT</id>
      <enabled>N</enabled>
      <name>CLIENT</name>
    </field>
  </job-log-table>
  <jobentry-log-table>
    <connection/>
    <schema/>
    <table/>
    <timeout_days/>
    <field>
      <id>ID_BATCH</id>
      <enabled>Y</enabled>
      <name>ID_BATCH</name>
    </field>
    <field>
      <id>CHANNEL_ID</id>
      <enabled>Y</enabled>
      <name>CHANNEL_ID</name>
    </field>
    <field>
      <id>LOG_DATE</id>
      <enabled>Y</enabled>
      <name>LOG_DATE</name>
    </field>
    <field>
      <id>JOBNAME</id>
      <enabled>Y</enabled>
      <name>TRANSNAME</name>
    </field>
    <field>
      <id>JOBENTRYNAME</id>
      <enabled>Y</enabled>
      <name>STEPNAME</name>
    </field>
    <field>
      <id>LINES_READ</id>
      <enabled>Y</enabled>
      <name>LINES_READ</name>
    </field>
    <field>
      <id>LINES_WRITTEN</id>
      <enabled>Y</enabled>
      <name>LINES_WRITTEN</name>
    </field>
    <field>
      <id>LINES_UPDATED</id>
      <enabled>Y</enabled>
      <name>LINES_UPDATED</name>
    </field>
    <field>
      <id>LINES_INPUT</id>
      <enabled>Y</enabled>
      <name>LINES_INPUT</name>
    </field>
    <field>
      <id>LINES_OUTPUT</id>
      <enabled>Y</enabled>
      <name>LINES_OUTPUT</name>
    </field>
    <field>
      <id>LINES_REJECTED</id>
      <enabled>Y</enabled>
      <name>LINES_REJECTED</name>
    </field>
    <field>
      <id>ERRORS</id>
      <enabled>Y</enabled>
      <name>ERRORS</name>
    </field>
    <field>
      <id>RESULT</id>
      <enabled>Y</enabled>
      <name>RESULT</name>
    </field>
    <field>
      <id>NR_RESULT_ROWS</id>
      <enabled>Y</enabled>
      <name>NR_RESULT_ROWS</name>
    </field>
    <field>
      <id>NR_RESULT_FILES</id>
      <enabled>Y</enabled>
      <name>NR_RESULT_FILES</name>
    </field>
    <field>
      <id>LOG_FIELD</id>
      <enabled>N</enabled>
      <name>LOG_FIELD</name>
    </field>
    <field>
      <id>COPY_NR</id>
      <enabled>N</enabled>
      <name>COPY_NR</name>
    </field>
  </jobentry-log-table>
  <channel-log-table>
    <connection/>
    <schema/>
    <table/>
    <timeout_days/>
    <field>
      <id>ID_BATCH</id>
      <enabled>Y</enabled>
      <name>ID_BATCH</name>
    </field>
    <field>
      <id>CHANNEL_ID</id>
      <enabled>Y</enabled>
      <name>CHANNEL_ID</name>
    </field>
    <field>
      <id>LOG_DATE</id>
      <enabled>Y</enabled>
      <name>LOG_DATE</name>
    </field>
    <field>
      <id>LOGGING_OBJECT_TYPE</id>
      <enabled>Y</enabled>
      <name>LOGGING_OBJECT_TYPE</name>
    </field>
    <field>
      <id>OBJECT_NAME</id>
      <enabled>Y</enabled>
      <name>OBJECT_NAME</name>
    </field>
    <field>
      <id>OBJECT_COPY</id>
      <enabled>Y</enabled>
      <name>OBJECT_COPY</name>
    </field>
    <field>
      <id>REPOSITORY_DIRECTORY</id>
      <enabled>Y</enabled>
      <name>REPOSITORY_DIRECTORY</name>
    </field>
    <field>
      <id>FILENAME</id>
      <enabled>Y</enabled>
      <name>FILENAME</name>
    </field>
    <field>
      <id>OBJECT_ID</id>
      <enabled>Y</enabled>
      <name>OBJECT_ID</name>
    </field>
    <field>
      <id>OBJECT_REVISION</id>
      <enabled>Y</enabled>
      <name>OBJECT_REVISION</name>
    </field>
    <field>
      <id>PARENT_CHANNEL_ID</id>
      <enabled>Y</enabled>
      <name>PARENT_CHANNEL_ID</name>
    </field>
    <field>
      <id>ROOT_CHANNEL_ID</id>
      <enabled>Y</enabled>
      <name>ROOT_CHANNEL_ID</name>
    </field>
  </channel-log-table>
  <pass_batchid>N</pass_batchid>
  <shared_objects_file/>
  <entries>
    <entry>
      <name>Start</name>
      <description/>
      <type>SPECIAL</type>
      <attributes/>
      <start>Y</start>
      <dummy>N</dummy>
      <repeat>N</repeat>
      <schedulerType>0</schedulerType>
      <intervalSeconds>0</intervalSeconds>
      <intervalMinutes>60</intervalMinutes>
      <hour>12</hour>
      <minutes>0</minutes>
      <weekDay>1</weekDay>
      <DayOfMonth>1</DayOfMonth>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>192</xloc>
      <yloc>160</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>GENERAZIONE DW</name>
      <description/>
      <type>SQL</type>
      <attributes/>
      <sql>DROP DATABASE northwind_dw;
CREATE DATABASE northwind_dw;
USE northwind_dw;

-- ****************************************************
-- *                    DT_SHIPPER                    *
-- ****************************************************
create table DT_SHIPPER (
   id_shipper  INTEGER(11) not null,
   companyName VARCHAR(40),
   constraint PK_DT_SHIPPER primary key (id_shipper)
);


-- ****************************************************
-- *                  DT2_CITYCOUNTRY                 *
-- ****************************************************
create table DT2_CITYCOUNTRY (
   id_city INTEGER(11) not null,
   city    VARCHAR(15),
   country VARCHAR(15),
   constraint PK_DT2_CITYCOUNTRY primary key (id_city)
);


-- ****************************************************
-- *                   DT2_TERRITORY                  *
-- ****************************************************
create table DT2_TERRITORY (
   id_territory         VARCHAR(20) not null,
   territoryDescription VARCHAR(50),
   region               INTEGER(11),
   regionDescription    VARCHAR(50),
   constraint PK_DT2_TERRITORY primary key (id_territory)
);


-- ****************************************************
-- *                   DT_ORDERDATE                   *
-- ****************************************************
create table DT_ORDERDATE (
   id_orderDate INTEGER(11) not null,
   orderDate    DATE,
   month        VARCHAR(20),
   quarter      INTEGER(5),
   year         INTEGER(5),
   constraint PK_DT_ORDERDATE primary key (id_orderDate)
);


-- ****************************************************
-- *                    DT_CUSTOMER                   *
-- ****************************************************
create table DT_CUSTOMER (
   id_customer   INTEGER(11) not null,
   customer      VARCHAR(5),
   companyName   VARCHAR(40),
   contactName   VARCHAR(30),
   contactTitle  VARCHAR(30),
   address       VARCHAR(60),
   postalCode    VARCHAR(10),
   customer_city INTEGER(11) not null,
   constraint PK_DT_CUSTOMER primary key (id_customer)
);

alter table DT_CUSTOMER
   add constraint R_citycountry1
   foreign key (customer_city) references DT2_CITYCOUNTRY (id_city);


-- ****************************************************
-- *                    DT_EMPLOYEE                   *
-- ****************************************************
create table DT_EMPLOYEE (
   id_employee   INTEGER(11) not null,
   fullName      VARCHAR(40),
   title         VARCHAR(30),
   address       VARCHAR(60),
   salary        VARCHAR(20),
   sex           VARCHAR(5),
   supervisor    INTEGER(11),
   employee_city INTEGER(11) not null,
   constraint PK_DT_EMPLOYEE primary key (id_employee)
);

alter table DT_EMPLOYEE
   add constraint R_EMPLOYEECITY
   foreign key (employee_city) references DT2_CITYCOUNTRY (id_city);

-- ****************************************************
-- *                    DT_PRODUCT                    *
-- ****************************************************
create table DT_PRODUCT (
   id_product          INTEGER(11) not null,
   productName         VARCHAR(40),
   quantityPerUnit     VARCHAR(20),
   rangeUnitPrice      VARCHAR(40),
   unitPrice           DECIMAL(10, 4),
   discontinued        BOOLEAN,
   category            INTEGER(11),
   categoryName        VARCHAR(15),
   categoryDescription MEDIUMTEXT,
   supplier            INTEGER(11),
   companyName         VARCHAR(40),
   contactName         VARCHAR(30),
   contactTitle        VARCHAR(30),
   address             VARCHAR(60),
   postalCode          VARCHAR(10),
   supplier_city       INTEGER not null,
   constraint PK_DT_PRODUCT primary key (id_product)
);

alter table DT_PRODUCT
   add constraint R_suppliercity
   foreign key (supplier_city) references DT2_CITYCOUNTRY (id_city);


-- ****************************************************
-- *              BRIDGE_EMPLOYTERRITORY              *
-- ****************************************************
create table BRIDGE_EMPLOYTERRITORY (
   employee  INTEGER(11) not null,
   territory VARCHAR(20) not null,
   constraint PK_BRIDGE_EMPLOYTERRITORY primary key (employee, territory)
);

alter table BRIDGE_EMPLOYTERRITORY
   add constraint R_bridge
   foreign key (territory) references DT2_TERRITORY (id_territory);

alter table BRIDGE_EMPLOYTERRITORY
   add constraint R_bridge2
   foreign key (employee) references DT_EMPLOYEE (id_employee);


-- ****************************************************
-- *                  FT_ORDERDETAILS                 *
-- ****************************************************
create table FT_ORDERDETAILS (
   id_customer  INTEGER(11) not null,
   id_employee  INTEGER(11) not null,
   id_product   INTEGER(11) not null,
   id_shipper   INTEGER(11) not null,
   id_orderDate INTEGER(11) not null,
   quantity     DOUBLE,
   freight      DECIMAL(10, 4),
   daysToShip   INTEGER(5),
   price        DECIMAL(10, 4),
   totalPrice   DECIMAL(10, 4),
   count        INTEGER(5),
   constraint PK_FT_ORDERDETAILS primary key (id_customer, id_employee, id_product, id_shipper, id_orderDate)
);

alter table FT_ORDERDETAILS
   add constraint R_OrderDate
   foreign key (id_orderDate) references DT_ORDERDATE (id_orderDate);

alter table FT_ORDERDETAILS
   add constraint R_Customer
   foreign key (id_customer) references DT_CUSTOMER (id_customer);

alter table FT_ORDERDETAILS
   add constraint R_PRODUCT
   foreign key (id_product) references DT_PRODUCT (id_product);

alter table FT_ORDERDETAILS
   add constraint R_SHIPPER
   foreign key (id_shipper) references DT_SHIPPER (id_shipper);

alter table FT_ORDERDETAILS
   add constraint R_EMPLOYEE
   foreign key (id_employee) references DT_EMPLOYEE (id_employee);


-- ****************************************************
-- *                 NAVIGATE_EMPLOYEE                *
-- ****************************************************
create table NAVIGATE_EMPLOYEE (
   supervisor INTEGER(11) not null,
   employee   INTEGER(11) not null,
   level      INTEGER(3),
   leaf       BOOLEAN,
   constraint PK_NAVIGATE_EMPLOYEE primary key (supervisor, employee)
);

alter table NAVIGATE_EMPLOYEE
   add constraint NAVIGATE1
   foreign key (supervisor) references DT_EMPLOYEE (id_employee);

alter table NAVIGATE_EMPLOYEE
   add constraint NAVIGATE2
   foreign key (employee) references DT_EMPLOYEE (id_employee);


</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>Connessione_DW</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>320</xloc>
      <yloc>160</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>CREAZIONE_DT_SECONDARIE</name>
      <description/>
      <type>TRANS</type>
      <attributes/>
      <specification_method>filename</specification_method>
      <trans_object_id/>
      <filename>${Internal.Entry.Current.Directory}/Trasformazione_DT_Secondarie.ktr</filename>
      <transname/>
      <arg_from_previous>N</arg_from_previous>
      <params_from_previous>N</params_from_previous>
      <exec_per_row>N</exec_per_row>
      <clear_rows>N</clear_rows>
      <clear_files>N</clear_files>
      <set_logfile>N</set_logfile>
      <logfile/>
      <logext/>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <loglevel>Basic</loglevel>
      <cluster>N</cluster>
      <slave_server_name/>
      <set_append_logfile>N</set_append_logfile>
      <wait_until_finished>Y</wait_until_finished>
      <follow_abort_remote>N</follow_abort_remote>
      <create_parent_folder>N</create_parent_folder>
      <logging_remote_work>N</logging_remote_work>
      <run_configuration>Pentaho local</run_configuration>
      <parameters>
        <pass_all_parameters>Y</pass_all_parameters>
      </parameters>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>480</xloc>
      <yloc>160</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>CREAZIONE_DT_PRIMARIE</name>
      <description/>
      <type>TRANS</type>
      <attributes/>
      <specification_method>filename</specification_method>
      <trans_object_id/>
      <filename>${Internal.Entry.Current.Directory}/Trasformazione_DT_Primarie.ktr</filename>
      <transname/>
      <arg_from_previous>N</arg_from_previous>
      <params_from_previous>N</params_from_previous>
      <exec_per_row>N</exec_per_row>
      <clear_rows>N</clear_rows>
      <clear_files>N</clear_files>
      <set_logfile>N</set_logfile>
      <logfile/>
      <logext/>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <loglevel>Basic</loglevel>
      <cluster>N</cluster>
      <slave_server_name/>
      <set_append_logfile>N</set_append_logfile>
      <wait_until_finished>Y</wait_until_finished>
      <follow_abort_remote>N</follow_abort_remote>
      <create_parent_folder>N</create_parent_folder>
      <logging_remote_work>N</logging_remote_work>
      <run_configuration>Pentaho local</run_configuration>
      <parameters>
        <pass_all_parameters>Y</pass_all_parameters>
      </parameters>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>656</xloc>
      <yloc>160</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>CREAZIONE_NAVIGATE_BRIDGE_TABLES</name>
      <description/>
      <type>TRANS</type>
      <attributes/>
      <specification_method>filename</specification_method>
      <trans_object_id/>
      <filename>${Internal.Entry.Current.Directory}/Trasformazione_Bridge_Navigate_Table.ktr</filename>
      <transname/>
      <arg_from_previous>N</arg_from_previous>
      <params_from_previous>N</params_from_previous>
      <exec_per_row>N</exec_per_row>
      <clear_rows>N</clear_rows>
      <clear_files>N</clear_files>
      <set_logfile>N</set_logfile>
      <logfile/>
      <logext/>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <loglevel>Basic</loglevel>
      <cluster>N</cluster>
      <slave_server_name/>
      <set_append_logfile>N</set_append_logfile>
      <wait_until_finished>Y</wait_until_finished>
      <follow_abort_remote>N</follow_abort_remote>
      <create_parent_folder>N</create_parent_folder>
      <logging_remote_work>N</logging_remote_work>
      <run_configuration>Pentaho local</run_configuration>
      <parameters>
        <pass_all_parameters>Y</pass_all_parameters>
      </parameters>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>848</xloc>
      <yloc>160</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>CREAZIONE_FACT_TABLE</name>
      <description/>
      <type>TRANS</type>
      <attributes/>
      <specification_method>filename</specification_method>
      <trans_object_id/>
      <filename>${Internal.Entry.Current.Directory}/Trasformazione_FT.ktr</filename>
      <transname/>
      <arg_from_previous>N</arg_from_previous>
      <params_from_previous>N</params_from_previous>
      <exec_per_row>N</exec_per_row>
      <clear_rows>N</clear_rows>
      <clear_files>N</clear_files>
      <set_logfile>N</set_logfile>
      <logfile/>
      <logext/>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <loglevel>Basic</loglevel>
      <cluster>N</cluster>
      <slave_server_name/>
      <set_append_logfile>N</set_append_logfile>
      <wait_until_finished>Y</wait_until_finished>
      <follow_abort_remote>N</follow_abort_remote>
      <create_parent_folder>N</create_parent_folder>
      <logging_remote_work>N</logging_remote_work>
      <run_configuration>Pentaho local</run_configuration>
      <parameters>
        <pass_all_parameters>Y</pass_all_parameters>
      </parameters>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>848</xloc>
      <yloc>272</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>Successo</name>
      <description/>
      <type>SUCCESS</type>
      <attributes/>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>192</xloc>
      <yloc>384</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>CREAZIONE VIEW GESTIONE BRIDGE TABLE</name>
      <description/>
      <type>SQL</type>
      <attributes/>
      <sql>CREATE TABLE view_bridge_table AS
SELECT e.id_employee, e.fullName, t.id_territory, t.territoryDescription, t.region, t.regionDescription
FROM dt_employee e, dt2_territory t, bridge_employterritory et
WHERE e.id_employee = et.employee AND t.id_territory = et.territory;

ALTER TABLE view_bridge_table
ADD PRIMARY KEY (`id_employee`, `id_territory`);

ALTER TABLE view_bridge_table 
ADD INDEX `FK_TERRITORY_idx` (`id_territory` ASC);

ALTER TABLE view_bridge_table
ADD CONSTRAINT `FK_EMPLOYEE`
  FOREIGN KEY (`id_employee`)
  REFERENCES `northwind_dw`.`dt_employee` (`id_employee`)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION,
ADD CONSTRAINT `FK_TERRITORY`
  FOREIGN KEY (`id_territory`)
  REFERENCES `northwind_dw`.`dt2_territory` (`id_territory`)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION;</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>Connessione_DW</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>848</xloc>
      <yloc>384</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>GENERAZIONE REC REL</name>
      <description/>
      <type>SQL</type>
      <attributes/>
      <sql>alter table DT_EMPLOYEE
   add constraint RECURSIVE_REL
   foreign key (supervisor) references DT_EMPLOYEE (id_employee);
</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>Connessione_DW</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>656</xloc>
      <yloc>384</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>CREAZIONE VIEW PAD</name>
      <description/>
      <type>SQL</type>
      <attributes/>
      <sql>-- Aggregate table view_customercity_productcateg
-- Estimated 2155 rows, 181020 bytes
CREATE TABLE `view_customercity_productcateg` (
    `dt2_citycountry_Customer_Count` VARCHAR(15),
    `dt2_citycountry_Customer_City` VARCHAR(15),
    `dt_product_CategoryDescription` MEDIUMTEXT,
    `dt_product_CategoryName` VARCHAR(15),
    `dt_product_Category` INT(11),
    `ft_orderdetails_Count` DOUBLE,
    `ft_orderdetails_Quantity_SUM` DOUBLE,
    `ft_orderdetails_Quantity_AVG` DOUBLE,
    `ft_orderdetails_Freight_AVG` DOUBLE,
    `ft_orderdetails_Freight_SUM` DOUBLE,
    `ft_orderdetails_DaysToShip` DOUBLE,
    `ft_orderdetails_TotalPrice` DOUBLE,
    `ft_orderdetails_Price` DOUBLE,
    `ft_orderdetails_fact_count` INTEGER);

-- Aggregate table view_month_shipper
-- Estimated 1050 rows, 54622 bytes
CREATE TABLE `view_month_shipper` (
    `dt_orderdate_Year` INT(5),
    `dt_orderdate_Quarter` INT(5),
    `dt_orderdate_Month` VARCHAR(20),
    `dt_shipper_Shipper_Company_Nam` VARCHAR(40),
    `dt_shipper_Shipper_Id` INT(11),
    `ft_orderdetails_Count` DOUBLE,
    `ft_orderdetails_Quantity_SUM` DOUBLE,
    `ft_orderdetails_Quantity_AVG` DOUBLE,
    `ft_orderdetails_Freight_AVG` DOUBLE,
    `ft_orderdetails_Freight_SUM` DOUBLE,
    `ft_orderdetails_DaysToShip` DOUBLE,
    `ft_orderdetails_TotalPrice` DOUBLE,
    `ft_orderdetails_Price` DOUBLE,
    `ft_orderdetails_fact_count` INTEGER);

-- Aggregate table view_customercity_rangeunitpri
-- Estimated 1862 rows, 111750 bytes
CREATE TABLE `view_customercity_rangeunitpri` (
    `dt2_citycountry_Customer_Count` VARCHAR(15),
    `dt2_citycountry_Customer_City` VARCHAR(15),
    `dt_product_RangeUnitPrice` VARCHAR(40),
    `ft_orderdetails_Count` DOUBLE,
    `ft_orderdetails_Quantity_SUM` DOUBLE,
    `ft_orderdetails_Quantity_AVG` DOUBLE,
    `ft_orderdetails_Freight_AVG` DOUBLE,
    `ft_orderdetails_Freight_SUM` DOUBLE,
    `ft_orderdetails_DaysToShip` DOUBLE,
    `ft_orderdetails_TotalPrice` DOUBLE,
    `ft_orderdetails_Price` DOUBLE,
    `ft_orderdetails_fact_count` INTEGER);

-- Aggregate table view_customer_productdiscontin
-- Estimated 2155 rows, 346955 bytes
CREATE TABLE `view_customer_productdiscontin` (
    `dt2_citycountry_Customer_Count` VARCHAR(15),
    `dt2_citycountry_Customer_City` VARCHAR(15),
    `dt_customer_Customer_CompanyNa` VARCHAR(40),
    `dt_customer_Customer_ContactNa` VARCHAR(30),
    `dt_customer_Customer_ContactTi` VARCHAR(30),
    `dt_customer_Customer_Address` VARCHAR(60),
    `dt_customer_Customer_PostalCod` VARCHAR(10),
    `dt_customer_Customer` VARCHAR(5),
    `dt_product_Discontinued` TINYINT(1),
    `ft_orderdetails_Count` DOUBLE,
    `ft_orderdetails_Quantity_SUM` DOUBLE,
    `ft_orderdetails_Quantity_AVG` DOUBLE,
    `ft_orderdetails_Freight_AVG` DOUBLE,
    `ft_orderdetails_Freight_SUM` DOUBLE,
    `ft_orderdetails_DaysToShip` DOUBLE,
    `ft_orderdetails_TotalPrice` DOUBLE,
    `ft_orderdetails_Price` DOUBLE,
    `ft_orderdetails_fact_count` INTEGER);

-- Aggregate table view_orderdate_customercountry
-- Estimated 2155 rows, 310320 bytes
CREATE TABLE `view_orderdate_customercountry` (
    `dt_orderdate_Year` INT(5),
    `dt_orderdate_Quarter` INT(5),
    `dt_orderdate_Month` VARCHAR(20),
    `dt_orderdate_OrderDate` DATE,
    `dt2_citycountry_Customer_Count` VARCHAR(15),
    `dt_product_CategoryDescription` MEDIUMTEXT,
    `dt_product_CategoryName` VARCHAR(15),
    `dt_product_Category` INT(11),
    `dt_product_Product_Id` INT(11),
    `dt2_citycountry_Employee_Count` VARCHAR(15),
    `dt2_citycountry_Employee_City` VARCHAR(15),
    `dt_employee_Employee_Id` INT(11),
    `ft_orderdetails_Count` DOUBLE,
    `ft_orderdetails_Quantity_SUM` DOUBLE,
    `ft_orderdetails_Quantity_AVG` DOUBLE,
    `ft_orderdetails_Freight_AVG` DOUBLE,
    `ft_orderdetails_Freight_SUM` DOUBLE,
    `ft_orderdetails_DaysToShip` DOUBLE,
    `ft_orderdetails_TotalPrice` DOUBLE,
    `ft_orderdetails_Price` DOUBLE,
    `ft_orderdetails_fact_count` INTEGER);

-- Aggregate table view_quarter_shipper_employee
-- Estimated 2155 rows, 163780 bytes
CREATE TABLE `view_quarter_shipper_employee` (
    `dt_orderdate_Year` INT(5),
    `dt_orderdate_Quarter` INT(5),
    `dt_shipper_Shipper_Company_Nam` VARCHAR(40),
    `dt_shipper_Shipper_Id` INT(11),
    `dt2_citycountry_Employee_Count` VARCHAR(15),
    `dt2_citycountry_Employee_City` VARCHAR(15),
    `dt_employee_Employee_Id` INT(11),
    `ft_orderdetails_Count` DOUBLE,
    `ft_orderdetails_Quantity_SUM` DOUBLE,
    `ft_orderdetails_Quantity_AVG` DOUBLE,
    `ft_orderdetails_Freight_AVG` DOUBLE,
    `ft_orderdetails_Freight_SUM` DOUBLE,
    `ft_orderdetails_DaysToShip` DOUBLE,
    `ft_orderdetails_TotalPrice` DOUBLE,
    `ft_orderdetails_Price` DOUBLE,
    `ft_orderdetails_fact_count` INTEGER);

-- Aggregate table view_year_rangeunitprice_terri
-- Estimated 2012 rows, 72447 bytes
CREATE TABLE `view_year_rangeunitprice_terri` (
    `dt_orderdate_Year` INT(5),
    `dt_product_RangeUnitPrice` VARCHAR(40),
    `view_bridge_table_Region_(Key)` INT(11),
    `view_bridge_table_Employee_(Ke` INT(11),
    `view_bridge_table_Territory_(K` VARCHAR(20),
    `ft_orderdetails_Count` DOUBLE,
    `ft_orderdetails_Quantity_SUM` DOUBLE,
    `ft_orderdetails_Quantity_AVG` DOUBLE,
    `ft_orderdetails_Freight_AVG` DOUBLE,
    `ft_orderdetails_Freight_SUM` DOUBLE,
    `ft_orderdetails_DaysToShip` DOUBLE,
    `ft_orderdetails_TotalPrice` DOUBLE,
    `ft_orderdetails_Price` DOUBLE,
    `ft_orderdetails_fact_count` INTEGER);

</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>Connessione_DW</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>480</xloc>
      <yloc>384</yloc>
      <attributes_kjc/>
    </entry>
    <entry>
      <name>POPOLAMENTO VIEW PAD</name>
      <description/>
      <type>SQL</type>
      <attributes/>
      <sql>-- Populate aggregate table view_customercity_productcateg
INSERT INTO `view_customercity_productcateg` (
    `dt2_citycountry_Customer_Count`,
    `dt2_citycountry_Customer_City`,
    `dt_product_CategoryDescription`,
    `dt_product_CategoryName`,
    `dt_product_Category`,
    `ft_orderdetails_Count`,
    `ft_orderdetails_Quantity_SUM`,
    `ft_orderdetails_Quantity_AVG`,
    `ft_orderdetails_Freight_AVG`,
    `ft_orderdetails_Freight_SUM`,
    `ft_orderdetails_DaysToShip`,
    `ft_orderdetails_TotalPrice`,
    `ft_orderdetails_Price`,
    `ft_orderdetails_fact_count`)
select
    `dt2_citycountry`.`country` as `dt2_citycountry_Customer_Count`,
    `dt2_citycountry`.`city` as `dt2_citycountry_Customer_City`,
    `dt_product`.`categoryDescription` as `dt_product_CategoryDescription`,
    `dt_product`.`categoryName` as `dt_product_CategoryName`,
    `dt_product`.`category` as `dt_product_Category`,
    sum(`ft_orderdetails`.`count`) as `ft_orderdetails_Count`,
    sum(`ft_orderdetails`.`quantity`) as `ft_orderdetails_Quantity_SUM`,
    avg(`ft_orderdetails`.`quantity`) as `ft_orderdetails_Quantity_AVG`,
    avg(`ft_orderdetails`.`freight`) as `ft_orderdetails_Freight_AVG`,
    sum(`ft_orderdetails`.`freight`) as `ft_orderdetails_Freight_SUM`,
    avg(`ft_orderdetails`.`daysToShip`) as `ft_orderdetails_DaysToShip`,
    sum(`ft_orderdetails`.`totalPrice`) as `ft_orderdetails_TotalPrice`,
    sum(`ft_orderdetails`.`price`) as `ft_orderdetails_Price`,
    count(*) as `ft_orderdetails_fact_count`
from
    `ft_orderdetails` as `ft_orderdetails`,
    `dt2_citycountry` as `dt2_citycountry`,
    `dt_customer` as `dt_customer`,
    `dt_product` as `dt_product`
where
    `ft_orderdetails`.`id_customer` = `dt_customer`.`id_customer`
and
    `dt_customer`.`customer_city` = `dt2_citycountry`.`id_city`
and
    `ft_orderdetails`.`id_product` = `dt_product`.`id_product`
group by
    `dt2_citycountry`.`country`,
    `dt2_citycountry`.`city`,
    `dt_product`.`categoryDescription`,
    `dt_product`.`categoryName`,
    `dt_product`.`category`;



-- Populate aggregate table view_month_shipper
INSERT INTO `view_month_shipper` (
    `dt_orderdate_Year`,
    `dt_orderdate_Quarter`,
    `dt_orderdate_Month`,
    `dt_shipper_Shipper_Company_Nam`,
    `dt_shipper_Shipper_Id`,
    `ft_orderdetails_Count`,
    `ft_orderdetails_Quantity_SUM`,
    `ft_orderdetails_Quantity_AVG`,
    `ft_orderdetails_Freight_AVG`,
    `ft_orderdetails_Freight_SUM`,
    `ft_orderdetails_DaysToShip`,
    `ft_orderdetails_TotalPrice`,
    `ft_orderdetails_Price`,
    `ft_orderdetails_fact_count`)
select
    `dt_orderdate`.`year` as `dt_orderdate_Year`,
    `dt_orderdate`.`quarter` as `dt_orderdate_Quarter`,
    `dt_orderdate`.`month` as `dt_orderdate_Month`,
    `dt_shipper`.`companyName` as `dt_shipper_Shipper_Company_Nam`,
    `dt_shipper`.`id_shipper` as `dt_shipper_Shipper_Id`,
    sum(`ft_orderdetails`.`count`) as `ft_orderdetails_Count`,
    sum(`ft_orderdetails`.`quantity`) as `ft_orderdetails_Quantity_SUM`,
    avg(`ft_orderdetails`.`quantity`) as `ft_orderdetails_Quantity_AVG`,
    avg(`ft_orderdetails`.`freight`) as `ft_orderdetails_Freight_AVG`,
    sum(`ft_orderdetails`.`freight`) as `ft_orderdetails_Freight_SUM`,
    avg(`ft_orderdetails`.`daysToShip`) as `ft_orderdetails_DaysToShip`,
    sum(`ft_orderdetails`.`totalPrice`) as `ft_orderdetails_TotalPrice`,
    sum(`ft_orderdetails`.`price`) as `ft_orderdetails_Price`,
    count(*) as `ft_orderdetails_fact_count`
from
    `ft_orderdetails` as `ft_orderdetails`,
    `dt_orderdate` as `dt_orderdate`,
    `dt_shipper` as `dt_shipper`
where
    `ft_orderdetails`.`id_orderDate` = `dt_orderdate`.`id_orderDate`
and
    `ft_orderdetails`.`id_shipper` = `dt_shipper`.`id_shipper`
group by
    `dt_orderdate`.`year`,
    `dt_orderdate`.`quarter`,
    `dt_orderdate`.`month`,
    `dt_shipper`.`companyName`,
    `dt_shipper`.`id_shipper`;



-- Populate aggregate table view_customercity_rangeunitpri
INSERT INTO `view_customercity_rangeunitpri` (
    `dt2_citycountry_Customer_Count`,
    `dt2_citycountry_Customer_City`,
    `dt_product_RangeUnitPrice`,
    `ft_orderdetails_Count`,
    `ft_orderdetails_Quantity_SUM`,
    `ft_orderdetails_Quantity_AVG`,
    `ft_orderdetails_Freight_AVG`,
    `ft_orderdetails_Freight_SUM`,
    `ft_orderdetails_DaysToShip`,
    `ft_orderdetails_TotalPrice`,
    `ft_orderdetails_Price`,
    `ft_orderdetails_fact_count`)
select
    `dt2_citycountry`.`country` as `dt2_citycountry_Customer_Count`,
    `dt2_citycountry`.`city` as `dt2_citycountry_Customer_City`,
    `dt_product`.`rangeUnitPrice` as `dt_product_RangeUnitPrice`,
    sum(`ft_orderdetails`.`count`) as `ft_orderdetails_Count`,
    sum(`ft_orderdetails`.`quantity`) as `ft_orderdetails_Quantity_SUM`,
    avg(`ft_orderdetails`.`quantity`) as `ft_orderdetails_Quantity_AVG`,
    avg(`ft_orderdetails`.`freight`) as `ft_orderdetails_Freight_AVG`,
    sum(`ft_orderdetails`.`freight`) as `ft_orderdetails_Freight_SUM`,
    avg(`ft_orderdetails`.`daysToShip`) as `ft_orderdetails_DaysToShip`,
    sum(`ft_orderdetails`.`totalPrice`) as `ft_orderdetails_TotalPrice`,
    sum(`ft_orderdetails`.`price`) as `ft_orderdetails_Price`,
    count(*) as `ft_orderdetails_fact_count`
from
    `ft_orderdetails` as `ft_orderdetails`,
    `dt2_citycountry` as `dt2_citycountry`,
    `dt_customer` as `dt_customer`,
    `dt_product` as `dt_product`
where
    `ft_orderdetails`.`id_customer` = `dt_customer`.`id_customer`
and
    `dt_customer`.`customer_city` = `dt2_citycountry`.`id_city`
and
    `ft_orderdetails`.`id_product` = `dt_product`.`id_product`
group by
    `dt2_citycountry`.`country`,
    `dt2_citycountry`.`city`,
    `dt_product`.`rangeUnitPrice`;



-- Populate aggregate table view_customer_productdiscontin
INSERT INTO `view_customer_productdiscontin` (
    `dt2_citycountry_Customer_Count`,
    `dt2_citycountry_Customer_City`,
    `dt_customer_Customer_CompanyNa`,
    `dt_customer_Customer_ContactNa`,
    `dt_customer_Customer_ContactTi`,
    `dt_customer_Customer_Address`,
    `dt_customer_Customer_PostalCod`,
    `dt_customer_Customer`,
    `dt_product_Discontinued`,
    `ft_orderdetails_Count`,
    `ft_orderdetails_Quantity_SUM`,
    `ft_orderdetails_Quantity_AVG`,
    `ft_orderdetails_Freight_AVG`,
    `ft_orderdetails_Freight_SUM`,
    `ft_orderdetails_DaysToShip`,
    `ft_orderdetails_TotalPrice`,
    `ft_orderdetails_Price`,
    `ft_orderdetails_fact_count`)
select
    `dt2_citycountry`.`country` as `dt2_citycountry_Customer_Count`,
    `dt2_citycountry`.`city` as `dt2_citycountry_Customer_City`,
    `dt_customer`.`companyName` as `dt_customer_Customer_CompanyNa`,
    `dt_customer`.`contactName` as `dt_customer_Customer_ContactNa`,
    `dt_customer`.`contactTitle` as `dt_customer_Customer_ContactTi`,
    `dt_customer`.`address` as `dt_customer_Customer_Address`,
    `dt_customer`.`postalCode` as `dt_customer_Customer_PostalCod`,
    `dt_customer`.`customer` as `dt_customer_Customer`,
    `dt_product`.`discontinued` as `dt_product_Discontinued`,
    sum(`ft_orderdetails`.`count`) as `ft_orderdetails_Count`,
    sum(`ft_orderdetails`.`quantity`) as `ft_orderdetails_Quantity_SUM`,
    avg(`ft_orderdetails`.`quantity`) as `ft_orderdetails_Quantity_AVG`,
    avg(`ft_orderdetails`.`freight`) as `ft_orderdetails_Freight_AVG`,
    sum(`ft_orderdetails`.`freight`) as `ft_orderdetails_Freight_SUM`,
    avg(`ft_orderdetails`.`daysToShip`) as `ft_orderdetails_DaysToShip`,
    sum(`ft_orderdetails`.`totalPrice`) as `ft_orderdetails_TotalPrice`,
    sum(`ft_orderdetails`.`price`) as `ft_orderdetails_Price`,
    count(*) as `ft_orderdetails_fact_count`
from
    `ft_orderdetails` as `ft_orderdetails`,
    `dt2_citycountry` as `dt2_citycountry`,
    `dt_customer` as `dt_customer`,
    `dt_product` as `dt_product`
where
    `ft_orderdetails`.`id_customer` = `dt_customer`.`id_customer`
and
    `dt_customer`.`customer_city` = `dt2_citycountry`.`id_city`
and
    `ft_orderdetails`.`id_product` = `dt_product`.`id_product`
group by
    `dt2_citycountry`.`country`,
    `dt2_citycountry`.`city`,
    `dt_customer`.`companyName`,
    `dt_customer`.`contactName`,
    `dt_customer`.`contactTitle`,
    `dt_customer`.`address`,
    `dt_customer`.`postalCode`,
    `dt_customer`.`customer`,
    `dt_product`.`discontinued`;



-- Populate aggregate table view_orderdate_customercountry
INSERT INTO `view_orderdate_customercountry` (
    `dt_orderdate_Year`,
    `dt_orderdate_Quarter`,
    `dt_orderdate_Month`,
    `dt_orderdate_OrderDate`,
    `dt2_citycountry_Customer_Count`,
    `dt_product_CategoryDescription`,
    `dt_product_CategoryName`,
    `dt_product_Category`,
    `dt_product_Product_Id`,
    `dt2_citycountry_Employee_Count`,
    `dt2_citycountry_Employee_City`,
    `dt_employee_Employee_Id`,
    `ft_orderdetails_Count`,
    `ft_orderdetails_Quantity_SUM`,
    `ft_orderdetails_Quantity_AVG`,
    `ft_orderdetails_Freight_AVG`,
    `ft_orderdetails_Freight_SUM`,
    `ft_orderdetails_DaysToShip`,
    `ft_orderdetails_TotalPrice`,
    `ft_orderdetails_Price`,
    `ft_orderdetails_fact_count`)
select
    `dt_orderdate`.`year` as `dt_orderdate_Year`,
    `dt_orderdate`.`quarter` as `dt_orderdate_Quarter`,
    `dt_orderdate`.`month` as `dt_orderdate_Month`,
    `dt_orderdate`.`orderDate` as `dt_orderdate_OrderDate`,
    `dt2_citycountry`.`country` as `dt2_citycountry_Customer_Count`,
    `dt_product`.`categoryDescription` as `dt_product_CategoryDescription`,
    `dt_product`.`categoryName` as `dt_product_CategoryName`,
    `dt_product`.`category` as `dt_product_Category`,
    `dt_product`.`id_product` as `dt_product_Product_Id`,
    `dt2_citycountry_2`.`country` as `dt2_citycountry_Employee_Count`,
    `dt2_citycountry_2`.`city` as `dt2_citycountry_Employee_City`,
    `dt_employee`.`id_employee` as `dt_employee_Employee_Id`,
    sum(`ft_orderdetails`.`count`) as `ft_orderdetails_Count`,
    sum(`ft_orderdetails`.`quantity`) as `ft_orderdetails_Quantity_SUM`,
    avg(`ft_orderdetails`.`quantity`) as `ft_orderdetails_Quantity_AVG`,
    avg(`ft_orderdetails`.`freight`) as `ft_orderdetails_Freight_AVG`,
    sum(`ft_orderdetails`.`freight`) as `ft_orderdetails_Freight_SUM`,
    avg(`ft_orderdetails`.`daysToShip`) as `ft_orderdetails_DaysToShip`,
    sum(`ft_orderdetails`.`totalPrice`) as `ft_orderdetails_TotalPrice`,
    sum(`ft_orderdetails`.`price`) as `ft_orderdetails_Price`,
    count(*) as `ft_orderdetails_fact_count`
from
    `ft_orderdetails` as `ft_orderdetails`,
    `dt_orderdate` as `dt_orderdate`,
    `dt2_citycountry` as `dt2_citycountry`,
    `dt_customer` as `dt_customer`,
    `dt_product` as `dt_product`,
    `dt2_citycountry` as `dt2_citycountry_2`,
    `dt_employee` as `dt_employee`
where
    `ft_orderdetails`.`id_orderDate` = `dt_orderdate`.`id_orderDate`
and
    `ft_orderdetails`.`id_customer` = `dt_customer`.`id_customer`
and
    `dt_customer`.`customer_city` = `dt2_citycountry`.`id_city`
and
    `ft_orderdetails`.`id_product` = `dt_product`.`id_product`
and
    `ft_orderdetails`.`id_employee` = `dt_employee`.`id_employee`
and
    `dt_employee`.`employee_city` = `dt2_citycountry_2`.`id_city`
group by
    `dt_orderdate`.`year`,
    `dt_orderdate`.`quarter`,
    `dt_orderdate`.`month`,
    `dt_orderdate`.`orderDate`,
    `dt2_citycountry`.`country`,
    `dt_product`.`categoryDescription`,
    `dt_product`.`categoryName`,
    `dt_product`.`category`,
    `dt_product`.`id_product`,
    `dt2_citycountry_2`.`country`,
    `dt2_citycountry_2`.`city`,
    `dt_employee`.`id_employee`;



-- Populate aggregate table view_quarter_shipper_employee
INSERT INTO `view_quarter_shipper_employee` (
    `dt_orderdate_Year`,
    `dt_orderdate_Quarter`,
    `dt_shipper_Shipper_Company_Nam`,
    `dt_shipper_Shipper_Id`,
    `dt2_citycountry_Employee_Count`,
    `dt2_citycountry_Employee_City`,
    `dt_employee_Employee_Id`,
    `ft_orderdetails_Count`,
    `ft_orderdetails_Quantity_SUM`,
    `ft_orderdetails_Quantity_AVG`,
    `ft_orderdetails_Freight_AVG`,
    `ft_orderdetails_Freight_SUM`,
    `ft_orderdetails_DaysToShip`,
    `ft_orderdetails_TotalPrice`,
    `ft_orderdetails_Price`,
    `ft_orderdetails_fact_count`)
select
    `dt_orderdate`.`year` as `dt_orderdate_Year`,
    `dt_orderdate`.`quarter` as `dt_orderdate_Quarter`,
    `dt_shipper`.`companyName` as `dt_shipper_Shipper_Company_Nam`,
    `dt_shipper`.`id_shipper` as `dt_shipper_Shipper_Id`,
    `dt2_citycountry_2`.`country` as `dt2_citycountry_Employee_Count`,
    `dt2_citycountry_2`.`city` as `dt2_citycountry_Employee_City`,
    `dt_employee`.`id_employee` as `dt_employee_Employee_Id`,
    sum(`ft_orderdetails`.`count`) as `ft_orderdetails_Count`,
    sum(`ft_orderdetails`.`quantity`) as `ft_orderdetails_Quantity_SUM`,
    avg(`ft_orderdetails`.`quantity`) as `ft_orderdetails_Quantity_AVG`,
    avg(`ft_orderdetails`.`freight`) as `ft_orderdetails_Freight_AVG`,
    sum(`ft_orderdetails`.`freight`) as `ft_orderdetails_Freight_SUM`,
    avg(`ft_orderdetails`.`daysToShip`) as `ft_orderdetails_DaysToShip`,
    sum(`ft_orderdetails`.`totalPrice`) as `ft_orderdetails_TotalPrice`,
    sum(`ft_orderdetails`.`price`) as `ft_orderdetails_Price`,
    count(*) as `ft_orderdetails_fact_count`
from
    `ft_orderdetails` as `ft_orderdetails`,
    `dt_orderdate` as `dt_orderdate`,
    `dt_shipper` as `dt_shipper`,
    `dt2_citycountry` as `dt2_citycountry_2`,
    `dt_employee` as `dt_employee`
where
    `ft_orderdetails`.`id_orderDate` = `dt_orderdate`.`id_orderDate`
and
    `ft_orderdetails`.`id_shipper` = `dt_shipper`.`id_shipper`
and
    `ft_orderdetails`.`id_employee` = `dt_employee`.`id_employee`
and
    `dt_employee`.`employee_city` = `dt2_citycountry_2`.`id_city`
group by
    `dt_orderdate`.`year`,
    `dt_orderdate`.`quarter`,
    `dt_shipper`.`companyName`,
    `dt_shipper`.`id_shipper`,
    `dt2_citycountry_2`.`country`,
    `dt2_citycountry_2`.`city`,
    `dt_employee`.`id_employee`;



-- Populate aggregate table view_year_rangeunitprice_terri
INSERT INTO `view_year_rangeunitprice_terri` (
    `dt_orderdate_Year`,
    `dt_product_RangeUnitPrice`,
    `view_bridge_table_Region_(Key)`,
    `view_bridge_table_Employee_(Ke`,
    `view_bridge_table_Territory_(K`,
    `ft_orderdetails_Count`,
    `ft_orderdetails_Quantity_SUM`,
    `ft_orderdetails_Quantity_AVG`,
    `ft_orderdetails_Freight_AVG`,
    `ft_orderdetails_Freight_SUM`,
    `ft_orderdetails_DaysToShip`,
    `ft_orderdetails_TotalPrice`,
    `ft_orderdetails_Price`,
    `ft_orderdetails_fact_count`)
select
    `dt_orderdate`.`year` as `dt_orderdate_Year`,
    `dt_product`.`rangeUnitPrice` as `dt_product_RangeUnitPrice`,
    `view_bridge_table`.`region` as `view_bridge_table_Region_(Key)`,
    `view_bridge_table`.`id_employee` as `view_bridge_table_Employee_(Ke`,
    `view_bridge_table`.`id_territory` as `view_bridge_table_Territory_(K`,
    sum(`ft_orderdetails`.`count`) as `ft_orderdetails_Count`,
    sum(`ft_orderdetails`.`quantity`) as `ft_orderdetails_Quantity_SUM`,
    avg(`ft_orderdetails`.`quantity`) as `ft_orderdetails_Quantity_AVG`,
    avg(`ft_orderdetails`.`freight`) as `ft_orderdetails_Freight_AVG`,
    sum(`ft_orderdetails`.`freight`) as `ft_orderdetails_Freight_SUM`,
    avg(`ft_orderdetails`.`daysToShip`) as `ft_orderdetails_DaysToShip`,
    sum(`ft_orderdetails`.`totalPrice`) as `ft_orderdetails_TotalPrice`,
    sum(`ft_orderdetails`.`price`) as `ft_orderdetails_Price`,
    count(*) as `ft_orderdetails_fact_count`
from
    `ft_orderdetails` as `ft_orderdetails`,
    `dt_orderdate` as `dt_orderdate`,
    `dt_product` as `dt_product`,
    `view_bridge_table` as `view_bridge_table`
where
    `ft_orderdetails`.`id_orderDate` = `dt_orderdate`.`id_orderDate`
and
    `ft_orderdetails`.`id_product` = `dt_product`.`id_product`
and
    `ft_orderdetails`.`id_employee` = `view_bridge_table`.`id_employee`
group by
    `dt_orderdate`.`year`,
    `dt_product`.`rangeUnitPrice`,
    `view_bridge_table`.`region`,
    `view_bridge_table`.`id_employee`,
    `view_bridge_table`.`id_territory`;



</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>Connessione_DW</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>320</xloc>
      <yloc>384</yloc>
      <attributes_kjc/>
    </entry>
  </entries>
  <hops>
    <hop>
      <from>Start</from>
      <to>GENERAZIONE DW</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>Y</unconditional>
    </hop>
    <hop>
      <from>GENERAZIONE DW</from>
      <to>CREAZIONE_DT_SECONDARIE</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>CREAZIONE_DT_SECONDARIE</from>
      <to>CREAZIONE_DT_PRIMARIE</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>CREAZIONE_DT_PRIMARIE</from>
      <to>CREAZIONE_NAVIGATE_BRIDGE_TABLES</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>CREAZIONE_NAVIGATE_BRIDGE_TABLES</from>
      <to>CREAZIONE_FACT_TABLE</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>CREAZIONE_FACT_TABLE</from>
      <to>CREAZIONE VIEW GESTIONE BRIDGE TABLE</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>CREAZIONE VIEW GESTIONE BRIDGE TABLE</from>
      <to>GENERAZIONE REC REL</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>GENERAZIONE REC REL</from>
      <to>CREAZIONE VIEW PAD</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>CREAZIONE VIEW PAD</from>
      <to>POPOLAMENTO VIEW PAD</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>POPOLAMENTO VIEW PAD</from>
      <to>Successo</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
  </hops>
  <notepads>
    <notepad>
      <note>JOB CREAZIONE ED ALIMENTAZIONE DATAWAREHOUSE</note>
      <xloc>352</xloc>
      <yloc>272</yloc>
      <width>321</width>
      <heigth>26</heigth>
      <fontname>Segoe UI</fontname>
      <fontsize>9</fontsize>
      <fontbold>Y</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>0</backgroundcolorred>
      <backgroundcolorgreen>255</backgroundcolorgreen>
      <backgroundcolorblue>64</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
  </notepads>
  <attributes>
    <group>
      <name>METASTORE.pentaho</name>
      <attribute>
        <key>Default Run Configuration</key>
        <value>{"namespace":"pentaho","id":"Default Run Configuration","name":"Default Run Configuration","description":"Defines a default run configuration","metaStoreName":null}</value>
      </attribute>
    </group>
    <group>
      <name>{"_":"Embedded MetaStore Elements","namespace":"pentaho","type":"Default Run Configuration"}</name>
      <attribute>
        <key>Pentaho local</key>
        <value>{"children":[{"children":[],"id":"server","value":null},{"children":[],"id":"clustered","value":"N"},{"children":[],"id":"name","value":"Pentaho local"},{"children":[],"id":"description","value":null},{"children":[],"id":"pentaho","value":"N"},{"children":[],"id":"readOnly","value":"Y"},{"children":[],"id":"sendResources","value":"N"},{"children":[],"id":"logRemoteExecutionLocally","value":"N"},{"children":[],"id":"remote","value":"N"},{"children":[],"id":"local","value":"Y"},{"children":[],"id":"showTransformations","value":"N"}],"id":"Pentaho local","value":null,"name":"Pentaho local","owner":null,"ownerPermissionsList":[]}</value>
      </attribute>
    </group>
  </attributes>
</job>
